<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Setting up investment analysis</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=cb25574f" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e031e9a9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Investment Evaluation in Excel" href="investment-evaluation-in-excel.html" />
    <link rel="prev" title="Major tasks in investment industry" href="major-tasks.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="setting-up-investment-analysis">
<h1>Setting up investment analysis<a class="headerlink" href="#setting-up-investment-analysis" title="Permalink to this heading">¶</a></h1>
<section id="setting-up-time-series-data-on-a-stock">
<h2>Setting up time series data on a stock<a class="headerlink" href="#setting-up-time-series-data-on-a-stock" title="Permalink to this heading">¶</a></h2>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>`
Short Summary: Download historic data</p>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a></p>
<p>Perhaps the most basic task that you may face when analyzing investments is just putting together pricing data on a stock. Let’s take a look at how this is done. Now there’s a lot of different sources out there for historical data on stocks, but one of my favorites, just because it’s free and readily available, is Yahoo! Finance. So you can go to finance.yahoo.com and then type in the ticker symbol for the company you’re looking for. In this case I’m going to use Microsoft. So we do that and it brings us to this page, the Microsoft stock “homepage.” Now, we’re looking for historical data. There’s a variety pieces of information here, I’m certainly not going to explain all of it, but what we’re mostly interested in right now, for our purposes, is grabbing historical data. Let’s pretend that we’re looking for daily stock price data over the last five years. Okay? So we’re going to take the data from March 6, 2014 through March 6, 2019, and we’re looking for this, historically, on a daily basis. I’m going to apply that set of settings and then download my data. When I do that, I’ll open it up in Excel. Okay, now we’ve got data on Microsoft stock, again, from March 6, 2014 all the way through the present day, or March 6, 2019. I can go to the bottom of the page by holding down the Control key and then hitting the Down Arrow key, and that takes me all the way down to the bottom, and I see we’ve got stock price data up through March 5, 2019. Now, notice there’s a few different columns of interest here. We’ve got the opening stock price data, the high on each day, the low stock price on each day, the close, and the adjusted close.</p>
<p>What do you think the difference is between these last two columns, close versus adjusted close? Any ideas?If you said that it’s taking into account the stock dividends paid out by Microsoft over time, you’re absolutely right. So Microsoft pays a dividend every quarter, and that comes out of the stock price. This adjusted close reflects that.</p>
<p>We’re probably not interested in some sort of an intraday trading strategy, so if I wanted to build a broader portfolio with multiple different sets of stocks in it, I’d probably just keep the adjusted close column along with the date column, and I might even drop that volume column, which just tells me how many shares of stock Microsoft trades on a daily basis. I could then go through and relabel this as Microsoft stock, and from here, if I wanted to get data on other companies for some sort of broader analysis, I could go through and do that very quickly and easily using exactly the same process that we just followed.</p>
</section>
<section id="computing-holding-period-returns">
<h2>Computing holding period returns<a class="headerlink" href="#computing-holding-period-returns" title="Permalink to this heading">¶</a></h2>
<p>Once you have basic pricing data on a stock, you may want to go through and calculate returns for that stock. Let’s see how this is done. Now, you may have a file with date and price closing data already. I’ve gone through and supplemented that with some information that we’d like to calculate in this section. I’m going to add a column for returns, a section for the <cite>mean 30-day return</cite>, and a random beginning and end date that I want to look up the prices on. Now, what I want to do to begin with is go through and complete a common task. I want to compute a 30-day holding period. In order to do that, I’m going to need to advance 30 days in pricing, right? So we’re looking at what’s the return if we’d bought on January 9th, 2014, and then fast forwarded 30 days. If we come down 30 days, we’ll be at February 21st, 2014, and our return for that 30-day period is B31, our final price, minus B2, $35.53, which is our initial price, all divided by our initial price. This gives us a return of 6.9% for this period. In order to go through and compute what we call rolling 30-day returns, I’ll simply drag-and-drop this formula all the way to the bottom of the sheet by clicking that fill cell handle. This will then give me 30-day returns that update each and every day as we move forward in time. Now, rather than calculating every single 30-day return, we may be interested in calculating an average for these. So if I’m looking for the mean 30-day return that means that I’m looking for the typical or average or normal 30-day return for this stock, which is Microsoft. Now, despite the official name mean, in Excel we can’t type mean. That’s not a function. And indeed, you can’t even find a specific function under the word mean. Instead, you have to use the more common or basic colloquial term average. So here we’re going to highlight the returns we’re interested in. In this case, that’ll be C31 through the bottom of the sheet, C259. And then we click enter, and this tells us that the mean 30-day return during this period is 2.68%. Now, let’s pretend hypothetically that we’ve calculated the 2.7% return for 30 days but that’s not really what we’re looking for. Instead, we want to know the return specific to a particular set of dates. If we’d hypothetically bought the stock on, say, March 25th, 2014, and sold it on August 13th, 2014, what would our return be? Well, that’s called a holding period return. And to compute it, we’re going to need to use a V lookup function. Now, the V lookup function, which I’ve got here, is going to look up the specific date that we bought the stock at, March 25th, 2014, and the date that we sold it at, August 13th, 2014, and the prices associated with those dates. So over here in V lookup, we’re telling it initially look up the sale date, August 13th, 2014, from this particular table running from A2 through B1259. And we’re looking in column two, which contains our pricing data, and we’re looking for an exact match. We’ll then do the same process to look up the price at the beginning of that time period. The price at the end, minus the price at the beginning, all divided by the price at the beginning, will give us our holding period return, which in this case is 9.3%. Now, the nice thing about doing this, rather than manually going through and looking up those prices on our own, is that if we want to change these dates, we easily can. Rather than selling on August 13th, if we’d sold on say, August 15th, our holding period return is now 11%. And rather than buying on March 25th, maybe we instead bought on March 27th, and our holding period return is 13.8%. So having constructed this function, we can easily go through and adjust and compute our holding period return for any particular set of dates over time. Now you too can calculate holding period returns for a single security in Excel.</p>
</section>
<section id="computing-time-series-momentum-market-timing">
<h2>Computing time series momentum: Market timing<a class="headerlink" href="#computing-time-series-momentum-market-timing" title="Permalink to this heading">¶</a></h2>
<p><cite>Rather than just looking at simple rolling historical returns, investors often want to compare these returns across different securities over time.</cite></p>
<p>In order to do this, you’ll want to look at the relative price of a stock compared to its own history to better understand the risk and returns there. Let me show you what I’m talking about. I’m in zero two zero three begin Excel file. Now, I’ve added a column here for <cite>percentile</cite>. In particular, what I’m interested in doing is understanding not just what my rolling returns are but if those rolling returns are particularly strong or particularly weak over time. In order to do that, I’m going to go through and evaluate the percentile that each rolling return falls into compared to the entire universe of returns. So in this equation I’m using the rank.EQ function. This goes through and ranks all numbers in a list from largest to smallest. And then I’m going to divide by the number of numbers that are there to understand what percentile a particular return falls into. So in this case we’re using the rank.EQ function and looking at the 6.9% rolling thirty day return that occurred on the period January 9th, 2014 though February 21st, 2014. And we want to compare that to all of the rolling returns that’ll take place over the next five years, now I know what you’re saying, I know what you’re thinking. Well, gee, if I’m here on February 21st, 2014 I wouldn’t know what the future returns are. Absolutely, you would not, I agree. Instead you would do this on a historical basis for trade strategy development. So again, we’re taking that 6.9% and comparing it to the universe of rolling returns from C-31 through C-1259, and then I’m looking for this to be ranked in a particular order, order number one which will rank from largest returns to smallest. Now I’m going to divide by the number of returns we have in our sample, in this case roughly 1220, right, and that’s going to give me a percentage, in this case I see that the rolling return of 6.9% is in about the 80th percentile for Microsoft stock, said differently this rolling return is larger than all but 20%` of 30 day rolling returns. So this is a very strong rolling return and we can compute this over time again by double clicking that fill cell handle. And this shows us the percentiles over time. Now this is useful because it enables up to go through and evaluate on any particular day what percentile does Microsoft’s recent performance fall into, just telling you that Microsoft has a 2.96% return over the last 30 days, it’s not that meaningful. Is that a high or low number, well I don’t know. Looking at percentiles I can tell you that’s kind of right in the middle. It’s in the 52nd percentile, 48% of the time the return is higher than that. 51% of the time it’s lower than that. So this is a very useful tool to establish the relative value of a stock compared to itself overtime or compared the peers. Now you’re ready to go through and use those rolling returns and rank stock based on the percentile their rolling returns fall into.</p>
</section>
<section id="compute-rolling-p-e-and-p-b-multiples-for-a-stock">
<h2>Compute rolling P/E and P/B multiples for a stock<a class="headerlink" href="#compute-rolling-p-e-and-p-b-multiples-for-a-stock" title="Permalink to this heading">¶</a></h2>
<p><cite>Investors often select stocks based on various valuation multiples, or metrics, like PE ratios, but you want to compute a set of historical ratios for your firm over time to give you a better sense for whether a particular stock is cheap or not. The problem is that these ratios or multiples will change over time as the company changes.</cite></p>
<p>Let me show you what I mean. I’m in the 02_04_Begin Excel file. Now what I’ve got here is data for Microsoft, and we have this data running from April 1st, 2014, through September 28th, 2018. We’ve got the closing price for this data. In addition, I’ve gone through, and gather data on Microsoft’s number of shares outstanding, net income, which is essentially their profit, their total sales or revenue, and the book value of the stock, or the book value of the company for every single date here. So on March 31st, 2014, for the first quarter of 2014, Microsoft had in our parlance 8,260 shares. Now in reality, these numbers will be in millions of dollars, okay? so this would be eight billion shares. Similarly, Microsoft had $5,660 in net income. Again, this is represented for ease of reading in millions of dollars. So it’s really $5.6 billion in net income. Now notice what happens. As we go forward one quarter in time, for the second quarter, Microsoft’s net income is going to change. It’s no longer the 5.6 billion, they had in Q1. Now it’s 4.6 billion, et cetera. Every quarter their net income, their number of shares outstanding, revenue, and book value will all change. And thus any multiples that we compute are going to need to change over time, because Microsoft’s profits, and sales, and book value are changing over time. We can’t base Microsoft’s PE ratio today on what it earned in 2014, so we would need to compute this on a rolling basis. To do that, I’ve got a merge up these two different datasets. This is tricky because we have quarterly data for the financials, and daily data for the stock prices. So I created a little formula that’s going to go through, and tell us the quarter that we should reference in each case. Now this formula basically just looks at the month in question of the price and the year, and then correlates to, the quarterly data that we’re looking at. So for April 1st, 2014, we won’t have second quarter data yet, we’ll instead have first quarter data. Our first quarter data for that period is going to be our earnings per share, our book value per share, and our sales per share. So I’m going to use our friend, the V Lookup function, and look up first quarter 2014 data, and the net income for that period, which comes out of column four. I look that up, and I divide it by the number of shares outstanding. That’s going to give me my earnings per share. I’ll follow a similar process for book value per share based on the book value of the company, and the number of shares, and for revenue per share based on total sales, and the number of shares. From here, I can go through, and compute my price to earnings ratio. The price to earnings ratio is simply our stock price divided by earnings per share. In this case that’ll be 15.1. Our price to book ratio will be the book value per share divided into the price, and then finally our price to sales ratio will be the price divided by our sales per share, so I’ve done that for this first date. We can do this on a rolling basis by just enabling that fill cell handle all the way through the end of the period. Now watch what’s happened here. If we scroll down to the point where we get to say, the end of the second quarter, and those second quarter results have been reported, now our earnings per share will change, our book value per share changes, and our sales per share change, and so do our PE ratio, our price to book ratio, and our price to sales ratio, and that’s how we go through, and compute these rolling ratios over time. Now you’re all set to go through, and compute valuation multiples for any stock you run across on a rolling basis.</p>
</section>
<section id="building-a-discounted-cash-flow-model">
<h2>Building a discounted cash flow model<a class="headerlink" href="#building-a-discounted-cash-flow-model" title="Permalink to this heading">¶</a></h2>
<p><cite>One of the more sophisticated fundamental valuation methods used by investment pros is called a dividend discount model.</cite></p>
<p>Let’s see how this type of model works and how you can put one together in Excel. I’m in the zero, two, zero, five begin Excel file. Now what we see here is a single stock and information related to it.</p>
<p><cite>We’ve got Microsoft’s price per share from the period beginning April 1st, 2014, through September 28th, 2018. We’ve also got the earnings per share, book value per share, and sales per share for the company during this period as well as various valuation multiples. PE ratio, price to book, price to sales, et cetera.</cite></p>
<p>Now in order to build our dividend discount model, we’re going to based that on financial information from the company. All firms that are publicly traded release quarterly information on their level of profits, revenues, assets, liabilities, and all sorts of other financial information. So in principle, you could go through and gather by hand information on the number of shares outstanding, the net income, the sales, et cetera for something like Microsoft. In practice, though, that can be a lot of work, especially if you’re dealing with a long period of time or multiple firms. So it’s much more likely, if you want to do this on a regular basis, you’d buy access to one of the many databases that are out there that have this information freely available for you to download and use, all right?</p>
<p>Now building on all that, we are going to use our dividend discount model to value Microsoft’s stock. We’re making a number of assumptions here. First of all, we’ve got a 50% payout ratio. We’re assuming that 50% of Microsoft’s net income will be spent on paying a dividend to shareholders each quarter. We’re also assuming that Microsoft’s dividend next year will be $0.47, and that’s based on the trailing, four quarters of net income, the 50% payout ratio, and the number of shares outstanding. So in this particular case, we’re assuming no growth in that dividend. Next, we will want to look at what the growth rate in Microsoft overall is.</p>
<p><cite>In order to compute that growth rate, we would look at Microsoft’s net income at the beginning of our sample period.</cite></p>
<p>In this case, the first quarter of 2014, and Microsoft’s net income at the end of our period in the second quarter of 2018. And then</p>
<p><cite>we can go through and use the geometric mean formula to determine what that growth rate is over time.</cite></p>
<p>So we’ve got our ending period net income minus our beginning period net income divided by our beginning net period net income. In order to determine a growth rate based on this, we have to take that fraction, add one to it, and then raise it to the one over number of years power. So in this case, we’ve got a four and a half year span, so it’s one over 4.5. And then finally, we subtract off one at the end and that gives us a growth rate for Microsoft in their net income during this period of 10.51%. Microsoft’s net income grew an average of 10.5% per year during this period.</p>
<p><cite>Finally, we’re making assumption about what the discount rate is. Our discount rate is based on the level of risk we think is entailed by Microsoft.</cite></p>
<p>A reasonable discount rate might be 11%. That’s roughly the average return on the market before inflation over time. We can go through and compute Microsoft’s value for the dividend discount model using these factors. The dividend next year, the growth rate, and the discount rate. If we assume no growth in the dividend for the next year, then we’ll just take our $0.47 and divide it by our discount rate minus our growth rate. 11% minus 10.5%. If we do think Microsoft will grow a little bit in value, then we would want to make one small change in this particular case. We’d want to assume that Microsoft’s dividend will grow at the same growth rate as the firm overall. Doing that adjusts the value of our stock from $96.19 per share up to about $106. How does that compare to where Microsoft actually is trading? Well, at this point in time, Microsoft was trading at $114.37, so based on our DDM model, Microsoft’s stock looks slightly overvalued. Now you’re all set to go through and compute and build your own dividend discount model and determine the resulting fundamental stock price.</p>
</section>
<section id="building-a-dividend-discount-model">
<h2>Building a dividend discount model<a class="headerlink" href="#building-a-dividend-discount-model" title="Permalink to this heading">¶</a></h2>
<p>Another common valuation method used by investment professionals is</p>
<p><cite>the DCF or discounted CF, or discounted cash flow model.</cite></p>
<p>This model uses projections about free cash flow or profitability of the firm to go through and determine the value of the stock on a fundamental basis. Let me show you how this works. I’m in the zero, two, zero, six begin Excel file. Now if you’ve noticed, we’ve got financial information for the company Microsoft over a period of time as well as stock price information over time. We want to build a DCF model. To do that, we’ll need to go through and forecast free cash flows. Now based on Microsoft’s net income, I’ve gone through and created some ad hoc free cash flow estimates that seem reasonable. If you’re interested in learning more specifically about how you go through and build detailed forecasting models for financials like this one, there’s a variety of great courses here on LinkedIn that help you to do that. Indeed, you can even use courses that will help you to forecast directly in Excel on a financial basis. Once we’ve got these free cash flows over time, we’re going to need to make a few more assumptions. We need to assume a discount rate. This discount rate is the rate of risk in the company. I’m using 11% here. That’s roughly the nominal rate of return on U.S. equities over the last century. So we’re going to use 11% as our discount rate for Microsoft. I’m using a terminal growth rate of 6%. This says, in essence, how fast do we think Microsoft can grow on an annual basis over the long term? 6% seems reasonable and then I’m going to go through and compute a terminal value.</p>
<p><cite>That terminal value will be based on Microsoft’s 2023 free cash flow, and its growth rate and its discount rate.</cite></p>
<p>So in this particular case, we are looking at a 6% terminal growth rate. So Microsoft’s free cash flow in 030 grows by an incremental 1.06, and then in order to determine our terminal value in the year 2024, we divide by the discount rate minus the terminal growth rate or 11% minus 6%. And that gives us a terminal value, in this case, of 1.100450. Now all of these numbers are in millions of dollars, so this would equate to a terminal value for Microsoft of roughly $1.1 trillion.</p>
<p><cite>Then finally, we’ve got our cash less debt. This is the amount of cash on hand at the company’s balance sheet level less the debt it has on hand. We can use all of these pieces to determine our discounted cash flow value.</cite></p>
<p>To do that, we are going to use the NPV function in Excel. NPV starts by taking our discount rate of 11% from K33 and then going through and using our free cash flows or our cash flow that the company has on its balance sheet for each of the ensuing periods. So initially, Microsoft has 95000 in our parlance of cash that could be returned to shareholders. Thereafter, they’re going to generate free cash flow of 35492, 39751, 42931, 45936, and then just under 52000. Again, all in millions of dollars. We go through, we add all of those metrics, and then we finally include our terminal value for the year 2024. Doing that gives us our net present value on the company as a whole. Finally, we need to divide by the number of shares outstanding, and this gives us a discount cash flow valuation for Microsoft of $98.58. Compared to Microsoft’s price at this time of $144.37, that tells us that Microsoft appears slightly overvalued compared to our DCF valuation. Now of course, it could be that we’re simply making assumptions that are just a tad too pessimistic. The nice thing about our DCF model in Excel is we can go through and change these assumptions and our DCF model will update automatically. If our terminal growth rate goes to 7%, Microsoft’s value now goes to 116. The stock looks fairly priced at present.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.jpeg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="major-tasks.html">Major tasks in investment industry</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setting up investment analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-time-series-data-on-a-stock">Setting up time series data on a stock</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-holding-period-returns">Computing holding period returns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-time-series-momentum-market-timing">Computing time series momentum: Market timing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-rolling-p-e-and-p-b-multiples-for-a-stock">Compute rolling P/E and P/B multiples for a stock</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-discounted-cash-flow-model">Building a discounted cash flow model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-dividend-discount-model">Building a dividend discount model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="investment-evaluation-in-excel.html">Investment Evaluation in Excel</a></li>
<li class="toctree-l1"><a class="reference internal" href="portfolio-performance-evaluation.html">Portfolio Performance Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="terms-formula.html">Terms and formula</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands.html">Commands</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">&lt;no title&gt;</a><ul>
      <li>Previous: <a href="major-tasks.html" title="previous chapter">Major tasks in investment industry</a></li>
      <li>Next: <a href="investment-evaluation-in-excel.html" title="next chapter">Investment Evaluation in Excel</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/tutorial/setting-up-analysis.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>