<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Investment Evaluation in Excel</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=cb25574f" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e031e9a9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Portfolio Performance Evaluation" href="portfolio-performance-evaluation.html" />
    <link rel="prev" title="Setting up investment analysis" href="setting-up-analysis.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="investment-evaluation-in-excel">
<h1>Investment Evaluation in Excel<a class="headerlink" href="#investment-evaluation-in-excel" title="Permalink to this heading">¶</a></h1>
<section id="computing-expected-returns-on-a-stock">
<h2>Computing expected returns on a stock<a class="headerlink" href="#computing-expected-returns-on-a-stock" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>The text explains how to use Excel to compute expected future returns for a single stock.</p></li>
<li><p>The text assumes that there are five possible scenarios for the stock’s performance over the next year, ranging from losing 10 percent to gaining 30 percent in value.</p></li>
<li><p>The text also requires assigning probabilities to each scenario, which can be based on the investor’s analysis of the company’s prospects.</p></li>
<li><p>The text implies that the expected future return is the weighted average of the returns under each scenario, multiplied by their probabilities.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">At</span> <span class="n">this</span> <span class="n">point</span> <span class="n">you</span> <span class="n">should</span> <span class="n">be</span> <span class="n">ready</span> <span class="n">to</span> <span class="n">start</span> <span class="n">doing</span>
<span class="n">some</span> <span class="n">basic</span> <span class="n">scenario</span> <span class="n">analysis</span> <span class="k">for</span> <span class="n">stocks</span> <span class="n">that</span> <span class="n">you</span> <span class="n">hold</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="using-probability-to-calculate-stock-returns">
<h2>Using probability to calculate stock returns<a class="headerlink" href="#using-probability-to-calculate-stock-returns" title="Permalink to this heading">¶</a></h2>
<p>Imagine you hold a portfolio with multiple stocks in it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Perhaps</span> <span class="n">you</span><span class="s1">&#39;re looking for a way to go through and</span>
<span class="n">determine</span> <span class="n">what</span> <span class="nb">type</span> <span class="n">of</span> <span class="k">return</span> <span class="n">you</span> <span class="n">might</span> <span class="n">expect</span> <span class="n">on</span> <span class="n">that</span> <span class="n">portfolio</span> <span class="n">over</span> <span class="n">time</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The text explains how to use Excel to calculate the expected return for different stocks based on various scenarios and probabilities.</p></li>
<li><p>The text assumes that the investor has some knowledge of the stocks and their potential outcomes, and can assign probabilities to each scenario.</p></li>
<li><p>The text shows how to use Excel to multiply the rate of return in each scenario by the probability of that scenario, and then sum up the results for each stock.</p></li>
<li><p>The text also suggests that the hardest part of this analysis is not the calculation, but the estimation of the probabilities, which requires some insight into the factors that affect the stocks.</p></li>
<li><p>The text explains how to calculate the expected return on a portfolio of stocks using Excel.</p></li>
<li><p>The text assumes that the investor has already estimated the probabilities and expected returns for each stock based on various scenarios.</p></li>
<li><p>The text shows how to use Excel to calculate the expected return for each stock based on its weight in the portfolio, and then sum up the results for all stocks.</p></li>
<li><p>The text also suggests that Excel can be used to modify the portfolio weights and expected returns over time as new information becomes available.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Now</span> <span class="n">you</span><span class="s1">&#39;re all set to go through and evaluate your own portfolio</span>
<span class="ow">and</span> <span class="n">start</span> <span class="n">to</span> <span class="n">think</span> <span class="n">about</span> <span class="n">the</span> <span class="n">scenarios</span> <span class="n">you</span> <span class="n">might</span> <span class="n">encounter</span><span class="p">,</span>
<span class="n">the</span> <span class="n">expected</span> <span class="n">rates</span> <span class="n">of</span> <span class="k">return</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">resulting</span> <span class="k">return</span> <span class="n">on</span> <span class="n">your</span> <span class="n">overall</span> <span class="n">portfolio</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="computing-arithmetic-and-geometric-returns-in-a-portfolio">
<h2>Computing arithmetic and geometric returns in a portfolio<a class="headerlink" href="#computing-arithmetic-and-geometric-returns-in-a-portfolio" title="Permalink to this heading">¶</a></h2>
<p>As an investor, one of the most critical tasks you face is going through and computing performance statistics on your portfolio.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Two</span> <span class="n">common</span> <span class="n">performance</span> <span class="n">statistics</span> <span class="n">you</span><span class="s1">&#39;ll probably want to be</span>
<span class="n">familiar</span> <span class="k">with</span> <span class="n">are</span> <span class="n">the</span> <span class="n">arithmetic</span> <span class="n">mean</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">geometric</span> <span class="n">mean</span><span class="o">.</span>
</pre></div>
</div>
<p>use the AVERAGE function by selecting the range of cells that contain the returns of each asset.</p>
<p><strong>Now, what does that arithmetic mean indicate or tell us?</strong></p>
<p>Well what it means is this is the return that an investor could expect on either of these assets in a single ordinary month. So in a typical average month, asset number one will return 1.32%.</p>
<p><strong>How does that differ from the geometric mean?</strong></p>
<p>Well the geometric mean tells us about the average growth rate over time. So, in order to calculate our geometric mean, we’re going to need to turn our returns from basic percentages into holding period returns.</p>
<ul class="simple">
<li><p>Take the percentages in Columns B and C, and add one to them for Columns D and E.</p></li>
<li><p>Use the GEOMEAN formula in Excel. Geometric means go through and multiply all of our returns together, and then subtract one off at the end.</p></li>
<li><p>To compute the geometric mean for asset number two, use the GEOMEAN formula, and then select the returns in question and subtract one at the end. The geometric mean for asset number two is 47.7 basis points.</p></li>
<li><p>The geometric mean for asset number one is 118 basis points.</p></li>
<li><p>The geometric mean is the growth rate for a typical month in this particular asset held over time. So if an asset manager tells you that their average return a particular month or year is, say, 5%, you might ask them, are you referring to the geometric mean or the arithmetic mean?12</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">If</span> <span class="n">you</span><span class="s1">&#39;re trying to understand how fast your money will grow over time,</span>
<span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">look</span> <span class="n">at</span> <span class="n">the</span> <span class="n">geometric</span> <span class="n">mean</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span><span class="s1">&#39;re trying to understand what a typical,</span>
<span class="n">ordinary</span> <span class="n">single</span> <span class="n">month</span> <span class="n">will</span> <span class="n">look</span> <span class="n">like</span> <span class="ow">and</span> <span class="n">whether</span> <span class="n">you</span><span class="s1">&#39;ll make or lose money in that month,</span>
<span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">look</span> <span class="n">at</span> <span class="n">the</span> <span class="n">arithmetic</span> <span class="n">mean</span><span class="o">.</span> <span class="n">Now</span> <span class="n">you</span> <span class="n">should</span> <span class="n">have</span> <span class="n">a</span> <span class="n">good</span> <span class="n">handle</span> <span class="n">on</span>
<span class="n">how</span> <span class="n">you</span> <span class="n">go</span> <span class="n">through</span> <span class="ow">and</span> <span class="n">calculate</span> <span class="n">arithmetic</span> <span class="ow">and</span> <span class="n">geometric</span> <span class="n">means</span> <span class="k">for</span> <span class="n">your</span> <span class="n">own</span> <span class="n">assets</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="computing-standard-deviation-and-variance-of-an-asset">
<h2>Computing standard deviation and variance of an asset<a class="headerlink" href="#computing-standard-deviation-and-variance-of-an-asset" title="Permalink to this heading">¶</a></h2>
<p>In addition to calculating your return statistics, as an investor you’ll probably need to go through and calculate different metrics for risk.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">There</span><span class="s1">&#39;s two different ways that you might calculate risk based on a portfolio.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Well</span> <span class="n">variance</span> <span class="ow">is</span> <span class="n">really</span> <span class="n">a</span> <span class="n">metric</span> <span class="n">that</span> <span class="n">establishes</span> <span class="ow">or</span> <span class="n">computes</span> <span class="n">how</span> <span class="n">spread</span> <span class="n">out</span> <span class="n">our</span> <span class="n">returns</span> <span class="n">are</span><span class="o">.</span>
</pre></div>
</div>
<p>So if a stock is up 30% one month and down 30% the next, it will have a high variance. A stock that is consistently returning about the same amount every month, will have a very low variance.</p>
<p>A related metric to variance is what’s called standard deviation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Standard</span> <span class="n">deviation</span> <span class="ow">is</span> <span class="n">simply</span> <span class="n">the</span> <span class="n">square</span> <span class="n">root</span> <span class="n">of</span> <span class="n">variance</span> <span class="ow">and</span> <span class="n">standard</span> <span class="n">deviation</span>
<span class="ow">is</span> <span class="n">important</span> <span class="n">because</span> <span class="n">it</span><span class="s1">&#39;s often used in the investment industry as a default measure</span>
<span class="k">for</span> <span class="n">the</span> <span class="n">risk</span> <span class="n">of</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">stock</span> <span class="ow">or</span> <span class="n">portfolio</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Variance dot P is based on a large population. Variance dot S, or sample, is used when we only have a subset of the returns. In this case, we want to use variance dot S1.</p></li>
<li><p>The standard deviation can be calculated in a similar fashion. Again we want the standard deviation of the sample rather than the population and for asset two, that’s going to come out to 1.22%.</p></li>
</ul>
<p>Sure! Here’s a summary of the variance and standard deviation calculation process:</p>
<p>To calculate the variance, we need to do the following:
1. Subtract the expected return from each possible rate of return.
2. Square each of these differences.
3. Multiply each squared difference by its probability.
4. Add up all of these products.</p>
<p>The formula for variance is:</p>
<p>$$sigma^2 = sum_{i=1}^{n} p_i (r_i - E(r))^2$$</p>
<p>where:
- $sigma^2$ is the variance
- $p_i$ is the probability of scenario i
- $r_i$ is the rate of return for scenario i
- $E(r)$ is the expected rate of return</p>
<p>To calculate the standard deviation, we take the square root of the variance.</p>
<p>The formula for standard deviation is:</p>
<p>$$sigma = sqrt{sigma^2}$$</p>
</section>
<section id="finding-covariances-and-correlations">
<h2>Finding covariances and correlations<a class="headerlink" href="#finding-covariances-and-correlations" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="n">key</span> <span class="n">part</span> <span class="n">of</span> <span class="n">building</span> <span class="n">a</span> <span class="n">portfolio</span> <span class="ow">is</span> <span class="n">making</span> <span class="n">sure</span> <span class="n">that</span> <span class="n">the</span> <span class="n">assets</span> <span class="n">that</span>
<span class="n">you</span> <span class="n">have</span> <span class="ow">in</span> <span class="n">that</span> <span class="n">portfolio</span> <span class="n">provide</span> <span class="n">diversification</span><span class="o">.</span>
</pre></div>
</div>
<p>Diversification helps to reduce the risk in that overall portfolio but how do we know if two assets are complimentary to one another?</p>
<p>How do we know if two assets will provide diversification when compared with one another?</p>
<blockquote>
<div><p>Now what we’ve got here are return data for two different assets over a period of time throughout the year. We’ve gone through and calculated the arithmetic means for each. Now what we need to do is go through and determine the covariance of these two assets.</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">covariance</span> <span class="n">tells</span> <span class="n">us</span> <span class="n">how</span> <span class="n">much</span> <span class="n">these</span> <span class="n">assets</span> <span class="n">move</span> <span class="ow">in</span> <span class="n">sink</span> <span class="k">with</span> <span class="n">one</span> <span class="n">another</span><span class="o">.</span>
<span class="n">A</span> <span class="n">positive</span> <span class="n">covariance</span> <span class="n">means</span> <span class="n">the</span> <span class="n">two</span> <span class="n">assets</span> <span class="n">will</span> <span class="n">tend</span> <span class="n">to</span> <span class="n">move</span> <span class="n">up</span> <span class="n">at</span> <span class="n">the</span> <span class="n">same</span> <span class="n">time</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The text gives an example of two share classes of Google that have a strong positive covariance and two stocks of different industries that have a negative or zero covariance.</p></li>
<li><p>The text demonstrates how to calculate the covariance of two assets using Excel by subtracting the mean from the return in each month and multiplying them together.</p></li>
<li><p>The text shows how to get the overall covariance by summing up the monthly covariances and dividing by the number of months minus one, which is a statistical adjustment for the sample size.</p></li>
<li><p>The text concludes that the two assets in the example have a negative covariance of -5.06, meaning they tend to move in opposite directions.</p></li>
<li><p>The text explains how to use the Excel covariance and correl formulas to get the same results as the manual calculation.</p></li>
<li><p>The text compares covariance and correlation and says that correlation is more meaningful because it is bounded by -1 and 1, indicating the strength and direction of the relationship between two assets.</p></li>
<li><p>The text shows that the two assets in the example have a high negative correlation of -0.75, meaning they move in opposite directions and provide good diversification.</p></li>
</ul>
</section>
<section id="computing-standard-deviation-and-variance-of-a-portfolio">
<h2>Computing standard deviation and variance of a portfolio<a class="headerlink" href="#computing-standard-deviation-and-variance-of-a-portfolio" title="Permalink to this heading">¶</a></h2>
<p>** Variance and standard deviation are two of the most common measures of risk.**</p>
<p>** Formula for variance of a portfolio:**</p>
<p>$$sigma^2 = sum_{i=1}^{n} w_i^2 sigma_i^2 + sum_{i=1}^{n} sum_{j=1}^{n} w_i w_j sigma_i sigma_j rho_{ij}$$</p>
<p>where:
- $sigma^2$ is the variance of the portfolio
- $w_i$ is the weight of asset i in the portfolio
- $sigma_i^2$ is the variance of asset i
- $rho_{ij}$ is the correlation between assets i and j</p>
<p>** Formula for standard deviation of a portfolio:**</p>
<p>$$sigma = sqrt{sigma^2}$$</p>
<p>Steps to calculate the standard deviation of a portfolio:
1. Calculate the variance of each asset in the portfolio.
2. Multiply the variance of each asset by its weight in the portfolio.
3. Multiply the covariance of each pair of assets by their weights in the portfolio.
4. Add up all of these products.
5. Take the square root of the result.</p>
</section>
<section id="computing-beta-of-an-asset">
<h2>Computing beta of an asset<a class="headerlink" href="#computing-beta-of-an-asset" title="Permalink to this heading">¶</a></h2>
<p>Often times, when you’re evaluating a portfolio, you may need to go through and determine what the beta is on a particular asset within that portfolio.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Beta</span> <span class="n">helps</span> <span class="n">us</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">how</span> <span class="n">risky</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">stock</span> <span class="ow">is</span>
<span class="ow">in</span> <span class="n">relation</span> <span class="n">to</span> <span class="n">the</span> <span class="n">market</span> <span class="n">overall</span><span class="p">,</span> <span class="n">which</span> <span class="ow">in</span> <span class="n">turn</span> <span class="n">helps</span> <span class="n">us</span> <span class="n">determine</span>
<span class="n">whether</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">that</span> <span class="n">stock</span> <span class="n">belongs</span> <span class="ow">in</span> <span class="n">our</span> <span class="n">portfolio</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Add up the value (number of shares multiplied by the share price) of each stock you own and your entire portfolio.</p></li>
<li><p>Based on these values, determine how much you have of each stock as a percentage of the overall portfolio.</p></li>
<li><p>Multiply those percentage figures by the appropriate beta for each stock.</p></li>
<li><p>Add up the weighted beta figures.</p></li>
<li><p>Running the regression of our portfolio of returns against the market returns gives us our beta.</p></li>
<li><p>That coefficient tells us the relationship between those two groups, the market versus our portfolio. That’s two different ways to calculate beta on your portfolio versus the market overall.</p></li>
</ul>
</section>
<section id="computing-risk-for-a-portfolio-with-many-stocks">
<h2>Computing risk for a portfolio with many stocks<a class="headerlink" href="#computing-risk-for-a-portfolio-with-many-stocks" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>we’ll go through and compute the mean return for this portfolio and finally we’ll determine what the variance or risk on the portfolio overall is. So to start with, we have what we call <strong>a variance covariance matrix.</strong></p>
</div></blockquote>
<p>This represents all of the pairs of covariances between the different assets in your portfolio.</p>
<p>variance covariance matrix is a square matrix that has the variance of each asset on the diagonal and the covariances between each pair of assets off the diagonal.</p>
</section>
<section id="computing-asset-allocation">
<h2>Computing asset allocation<a class="headerlink" href="#computing-asset-allocation" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Many</span> <span class="n">investors</span> <span class="n">want</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">portfolios</span> <span class="n">containing</span> <span class="n">a</span> <span class="n">mixture</span> <span class="n">of</span> <span class="n">stocks</span> <span class="ow">and</span> <span class="n">bonds</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">it</span><span class="s1">&#39;s probably a good idea to balance stocks and bonds together.</span>
</pre></div>
</div>
<p>To calculate the expected portfolio returns in Excel, you can use the following formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ep</span> <span class="o">=</span> <span class="n">w1E1</span> <span class="o">+</span> <span class="n">w2E2</span> <span class="o">+</span> <span class="n">w3E3</span>
</pre></div>
</div>
<p>where w n refers to the portfolio weight of each asset and E n its expected return1.</p>
<p>You can use this formula to determine the growth rate in stocks or bonds and calculate the portfolio’s overall rate of return using Microsoft Excel.</p>
</section>
<section id="computing-cross-sectional-momentum">
<h2>Computing cross-sectional momentum<a class="headerlink" href="#computing-cross-sectional-momentum" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Portfolio</span> <span class="n">management</span> <span class="n">requires</span> <span class="n">deciding</span> <span class="n">on</span> <span class="n">how</span> <span class="n">to</span> <span class="n">balance</span> <span class="n">between</span> <span class="n">different</span> <span class="n">investments</span>
<span class="ow">in</span> <span class="n">a</span> <span class="n">portfolio</span><span class="p">,</span> <span class="ow">and</span> <span class="n">one</span> <span class="n">good</span> <span class="n">way</span> <span class="n">to</span> <span class="n">do</span> <span class="n">that</span> <span class="ow">is</span> <span class="n">by</span> <span class="n">looking</span> <span class="n">at</span> <span class="n">security</span> <span class="n">momentum</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">point</span> <span class="n">here</span> <span class="ow">is</span> <span class="n">that</span> <span class="n">even</span> <span class="n">though</span> <span class="n">we</span> <span class="n">have</span> <span class="n">relatively</span> <span class="n">low</span> <span class="n">correlations</span> <span class="n">between</span>
<span class="n">these</span> <span class="n">securities</span> <span class="n">individually</span><span class="p">,</span> <span class="n">those</span> <span class="n">correlations</span> <span class="n">can</span> <span class="n">change</span> <span class="n">very</span> <span class="n">rapidly</span> <span class="n">over</span> <span class="n">time</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>Steps to compute security momentum:</strong></p>
<ol class="arabic simple">
<li><p>Calculate the returns for each security over a given period of time.</p></li>
<li><p>Rank the securities based on their returns.</p></li>
<li><p>Select the top 10 securities and invest in them.</p></li>
<li><p>Repeat the process every month.</p></li>
</ol>
</section>
<section id="computing-correlations-between-stocks">
<h2>Computing correlations between stocks<a class="headerlink" href="#computing-correlations-between-stocks" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">One</span> <span class="n">way</span> <span class="n">to</span> <span class="n">reduce</span> <span class="n">risk</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">portfolio</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">hold</span> <span class="n">a</span>
<span class="n">broadly</span> <span class="n">diversified</span> <span class="nb">set</span> <span class="n">of</span> <span class="n">investments</span><span class="p">,</span> <span class="n">but</span> <span class="n">to</span> <span class="n">get</span> <span class="n">diversification</span><span class="p">,</span>
<span class="n">you</span> <span class="n">first</span> <span class="n">have</span> <span class="n">to</span> <span class="n">calculate</span> <span class="n">correlations</span> <span class="n">between</span> <span class="n">asset</span> <span class="n">prices</span><span class="o">.</span>
<span class="n">Skip</span> <span class="n">this</span> <span class="n">step</span> <span class="ow">and</span> <span class="n">you</span> <span class="n">may</span> <span class="n">find</span> <span class="n">that</span> <span class="n">a</span> <span class="n">portfolio</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">lot</span> <span class="n">riskier</span> <span class="n">than</span> <span class="n">you</span> <span class="n">thought</span> <span class="n">it</span> <span class="n">was</span><span class="o">.</span>
</pre></div>
</div>
<p>Now notice, we cannot use correlations based on prices. We’ve got to have our correlations run based on our returns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Diversification</span> <span class="n">works</span> <span class="n">worst</span> <span class="n">when</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">needed</span> <span class="n">most</span><span class="o">.</span>
<span class="n">That</span><span class="s1">&#39;s an unfortunate reality as an investor, but it&#39;</span><span class="n">s</span> <span class="n">one</span> <span class="n">that</span>
<span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">aware</span> <span class="n">of</span> <span class="ow">in</span> <span class="n">considering</span> <span class="n">when</span> <span class="n">you</span> <span class="n">build</span> <span class="n">your</span> <span class="n">portfolio</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="evaluating-hedge-funds-and-mutual-funds-with-portfolio-attribution">
<h2>Evaluating hedge funds and mutual funds with portfolio attribution<a class="headerlink" href="#evaluating-hedge-funds-and-mutual-funds-with-portfolio-attribution" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">More</span> <span class="n">advanced</span> <span class="n">portfolio</span> <span class="n">analysis</span> <span class="n">should</span> <span class="n">take</span> <span class="n">into</span>
<span class="n">account</span> <span class="n">factor</span> <span class="n">models</span> <span class="n">like</span> <span class="n">the</span> <span class="n">Fama</span> <span class="ow">and</span> <span class="n">French</span> <span class="n">model</span><span class="o">.</span>
</pre></div>
</div>
<p>We’ve also got what are known as factors:
- the size factor,
- the value factor,
- the risk free rate,
- and the VIX.
- We’ve also got our friend beta which is labeled here just market minus risk free.</p>
<p>Now, what we want to understand is how much of the returns for a hedge fund or a mutual fund are driven by exposure to one of these factors.
In other words,
is that hedge fund really picking good stocks or are they just loading up on high beta stocks?</p>
<p>Are they just loading up on stocks that score well on the size, SMV, and the value, HML, factors?</p>
<p>How can we do this type of portfolio attribution analysis as it’s called?</p>
<p>Regression analysis is the tool we’re going to need. So I’m going to go to the data tab and then click the data analysis button.</p>
<p><strong>Steps to perform regression analysis in Python:</strong></p>
<ol class="arabic simple">
<li><p>Load the data into a Pandas DataFrame.</p></li>
<li><p>Use the statsmodels.formula.api.ols function to run the regression.</p></li>
<li><p>Use the summary function to view the results.</p></li>
</ol>
</section>
<section id="valuing-a-bond-in-excel">
<h2>Valuing a bond in Excel<a class="headerlink" href="#valuing-a-bond-in-excel" title="Permalink to this heading">¶</a></h2>
<p>Bond valuation can be done quickly and effectively in Excel, let’s see how it works. Now let’s pretend we have a bond,
in that bond we’ve got five different major characteristics we care about and this is true of all bonds in fact.
- Maturity
- coupon
- par value
- the discount rate, or yield on the bond
- and the price of the bond.</p>
<p>Now generally when we’re evaluating a bond, we’re trying to use some of these characteristics to predict price or the price that we think the bond should trade in.</p>
<p><code class="docutils literal notranslate"><span class="pre">So</span> <span class="pre">maturity</span> <span class="pre">is</span> <span class="pre">simply</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">time</span> <span class="pre">until</span> <span class="pre">that</span> <span class="pre">bond</span> <span class="pre">matures,</span> <span class="pre">until</span> <span class="pre">it's</span> <span class="pre">going</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">repaid</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">investor.</span>
<span class="pre">The</span> <span class="pre">coupon</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">interest</span> <span class="pre">rate</span> <span class="pre">we</span> <span class="pre">receive</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">bond</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">par</span> <span class="pre">value</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">amount</span> <span class="pre">of</span> <span class="pre">money</span> <span class="pre">that</span> <span class="pre">we'll</span> <span class="pre">get</span> <span class="pre">back</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">future.</span> <span class="pre">All</span> <span class="pre">three</span> <span class="pre">of</span> <span class="pre">those</span> <span class="pre">are</span> <span class="pre">going</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">given.</span> <span class="pre">These</span> <span class="pre">let</span> <span class="pre">us</span> <span class="pre">go</span> <span class="pre">through</span> <span class="pre">and</span> <span class="pre">create</span> <span class="pre">a</span> <span class="pre">schedule</span> <span class="pre">of</span> <span class="pre">cash</span> <span class="pre">flows</span> <span class="pre">which</span> <span class="pre">is</span> <span class="pre">critical</span> <span class="pre">to</span> <span class="pre">determining</span> <span class="pre">what</span> <span class="pre">we</span> <span class="pre">think</span> <span class="pre">the</span> <span class="pre">price</span> <span class="pre">or</span> <span class="pre">yield</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">on</span> <span class="pre">that</span> <span class="pre">bond.</span> <span class="pre">So</span> <span class="pre">in</span> <span class="pre">this</span> <span class="pre">case</span> <span class="pre">our</span> <span class="pre">cash</span> <span class="pre">flows</span> <span class="pre">are</span> <span class="pre">simply</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">coupon</span> <span class="pre">times</span> <span class="pre">the</span> <span class="pre">par</span> <span class="pre">value.</span> <span class="pre">I'm</span> <span class="pre">going</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">this</span> <span class="pre">same</span> <span class="pre">formula</span> <span class="pre">across</span> <span class="pre">all</span> <span class="pre">19</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">first</span> <span class="pre">19</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">20</span> <span class="pre">years.</span> <span class="pre">The</span> <span class="pre">cash</span> <span class="pre">flow</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">bond</span> <span class="pre">is</span> <span class="pre">always</span> <span class="pre">going</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">coupon</span> <span class="pre">times</span> <span class="pre">par</span> <span class="pre">value.</span> <span class="pre">In</span> <span class="pre">my</span> <span class="pre">final</span> <span class="pre">year</span> <span class="pre">I</span> <span class="pre">get</span> <span class="pre">repaid</span> <span class="pre">the</span> <span class="pre">par</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">bond,</span> <span class="pre">plus</span> <span class="pre">I</span> <span class="pre">get</span> <span class="pre">my</span> <span class="pre">five</span> <span class="pre">percent</span> <span class="pre">coupon.</span> <span class="pre">Now</span> <span class="pre">I</span> <span class="pre">understand</span> <span class="pre">that</span> <span class="pre">obviously</span> <span class="pre">bonds</span> <span class="pre">are</span> <span class="pre">frequently</span> <span class="pre">semi-annual</span> <span class="pre">we</span> <span class="pre">haven't</span> <span class="pre">accounted</span> <span class="pre">for</span> <span class="pre">that</span> <span class="pre">here</span> <span class="pre">for</span> <span class="pre">simplicity</span> <span class="pre">and</span> <span class="pre">we</span> <span class="pre">also</span> <span class="pre">assume</span> <span class="pre">that</span> <span class="pre">we</span> <span class="pre">get</span> <span class="pre">paid</span> <span class="pre">the</span> <span class="pre">coupon</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">par</span> <span class="pre">value</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">same</span> <span class="pre">point</span> <span class="pre">in</span> <span class="pre">time</span> <span class="pre">in</span> <span class="pre">year</span> <span class="pre">20.</span> <span class="pre">Again</span> <span class="pre">we're</span> <span class="pre">just</span> <span class="pre">doing</span> <span class="pre">this</span> <span class="pre">to</span> <span class="pre">kind</span> <span class="pre">of</span> <span class="pre">abstract</span> <span class="pre">away</span> <span class="pre">from</span> <span class="pre">some</span> <span class="pre">of</span> <span class="pre">that</span> <span class="pre">technical</span> <span class="pre">detail.</span> <span class="pre">It's</span> <span class="pre">going</span> <span class="pre">to</span> <span class="pre">give</span> <span class="pre">us</span> <span class="pre">an</span> <span class="pre">approximation</span> <span class="pre">for</span> <span class="pre">what</span> <span class="pre">we</span> <span class="pre">care</span> <span class="pre">about</span> <span class="pre">though.</span> <span class="pre">So</span> <span class="pre">next</span> <span class="pre">up</span> <span class="pre">we're</span> <span class="pre">going</span> <span class="pre">to</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">pick</span> <span class="pre">a</span> <span class="pre">discount</span> <span class="pre">rate</span> <span class="pre">in</span> <span class="pre">order</span> <span class="pre">to</span> <span class="pre">get</span> <span class="pre">our</span> <span class="pre">price</span> <span class="pre">or</span> <span class="pre">value</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">bond.</span></code></p>
<p>What discount rate should we use?
Well that’s going to depend on the risk of the bond.</p>
<ul class="simple">
<li><p>If it’s a very safe bond, we might use a low discount rate.</p></li>
<li><p>If it’s a very risky bond, we might use a high discount rate.</p></li>
</ul>
<p>** Formula to compute present value of a bond:**</p>
<p>$$PV = sum_{t=1}^{n} frac{CF_t}{(1 + r)^t}$$</p>
<p>where:
- $PV$ is the present value of the bond
- $CF_t$ is the cash flow in period t
- $r$ is the discount rate
- $n$ is the number of periods</p>
<p><strong>Steps to calculate the present value of a bond in Python:</strong></p>
<ol class="arabic simple">
<li><p>Load the data into a Pandas DataFrame.</p></li>
<li><p>Use the numpy.pv function to calculate the present value of each cash flow.</p></li>
<li><p>Sum up the present values to get the total present value of the bond.</p></li>
</ol>
</section>
<section id="performing-scenario-analysis">
<h2>Performing scenario analysis<a class="headerlink" href="#performing-scenario-analysis" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Oftentimes</span><span class="p">,</span> <span class="n">investors</span> <span class="n">want</span> <span class="n">to</span> <span class="n">go</span> <span class="n">beyond</span> <span class="n">basic</span> <span class="n">bond</span> <span class="n">analysis</span><span class="p">,</span>
 <span class="ow">and</span> <span class="n">consider</span> <span class="n">how</span> <span class="n">the</span> <span class="n">bond</span><span class="s1">&#39;s value will change under various scenarios.</span>
</pre></div>
</div>
<p><strong>Steps to perform scenario analysis in Python:</strong></p>
<ol class="arabic simple">
<li><p>Load the data into a Pandas DataFrame.</p></li>
<li><p>Use the numpy.pv function to calculate the present value of each cash flow.</p></li>
<li><p>Sum up the present values to get the total present value of the bond.</p></li>
<li><p>Change the discount rate to reflect the new scenario.</p></li>
<li><p>Repeat steps 2 and 3 to calculate the present value of the bond under the new scenario.</p></li>
</ol>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.jpeg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="major-tasks.html">Major tasks in investment industry</a></li>
<li class="toctree-l1"><a class="reference internal" href="setting-up-analysis.html">Setting up investment analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Investment Evaluation in Excel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#computing-expected-returns-on-a-stock">Computing expected returns on a stock</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-probability-to-calculate-stock-returns">Using probability to calculate stock returns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-arithmetic-and-geometric-returns-in-a-portfolio">Computing arithmetic and geometric returns in a portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-standard-deviation-and-variance-of-an-asset">Computing standard deviation and variance of an asset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finding-covariances-and-correlations">Finding covariances and correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-standard-deviation-and-variance-of-a-portfolio">Computing standard deviation and variance of a portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-beta-of-an-asset">Computing beta of an asset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-risk-for-a-portfolio-with-many-stocks">Computing risk for a portfolio with many stocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-asset-allocation">Computing asset allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-cross-sectional-momentum">Computing cross-sectional momentum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-correlations-between-stocks">Computing correlations between stocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#evaluating-hedge-funds-and-mutual-funds-with-portfolio-attribution">Evaluating hedge funds and mutual funds with portfolio attribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#valuing-a-bond-in-excel">Valuing a bond in Excel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#performing-scenario-analysis">Performing scenario analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="portfolio-performance-evaluation.html">Portfolio Performance Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="terms-formula.html">Terms and formula</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands.html">Commands</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">&lt;no title&gt;</a><ul>
      <li>Previous: <a href="setting-up-analysis.html" title="previous chapter">Setting up investment analysis</a></li>
      <li>Next: <a href="portfolio-performance-evaluation.html" title="next chapter">Portfolio Performance Evaluation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/tutorial/investment-evaluation-in-excel.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>